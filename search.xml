<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>利用 Github Actions 自动部署 Hexo 搭建博客到Github Pages</title>
      <link href="/2022/01/24/li-yong-github-actions-zi-dong-bu-shu-hexo-dao-github-pages/"/>
      <url>/2022/01/24/li-yong-github-actions-zi-dong-bu-shu-hexo-dao-github-pages/</url>
      
        <content type="html"><![CDATA[<h1 id="开始之前准备"><a href="#开始之前准备" class="headerlink" title="开始之前准备"></a>开始之前准备</h1><h2 id="本地安装"><a href="#本地安装" class="headerlink" title="本地安装"></a>本地安装</h2><ul><li><a href="https://nodejs.org/zh-cn/">Node.js</a></li><li><a href="https://gitforwindows.org/">Git</a></li></ul><h2 id="所需账号"><a href="#所需账号" class="headerlink" title="所需账号"></a>所需账号</h2><ul><li><a href="https://github.com/">Github</a>账号</li></ul><blockquote><p><font color="#6667AB">请自行下载安装配置环境和注册账号</font></p></blockquote><hr><h1 id="开始"><a href="#开始" class="headerlink" title="开始"></a>开始</h1><h2 id="部署Hexo"><a href="#部署Hexo" class="headerlink" title="部署Hexo"></a>部署<a href="https://hexo.io/zh-cn/index.html">Hexo</a></h2><p>一、打开Git Bash Here</p><p>桌面右键点击打开</p><p><img src="https://cdn.jsdelivr.net/gh/C-Plusone/Pic@main/blog/01pic/blog01.jpg"></p><p>按照<a href="https://hexo.io/zh-cn/index.html">Hexo官网</a>命令复制粘贴</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">npm</span> <span class="token function">install</span> hexo-cli -ghexo init blog<span class="token builtin class-name">cd</span> blog<span class="token function">npm</span> <span class="token function">install</span>hexo server<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>输完最后一个命令出现下图表示成功</p><p><img src="https://cdn.jsdelivr.net/gh/C-Plusone/Pic@main/blog/01pic/blog02.jpg"></p><p>然后用浏览器打开 <a href="http://localhost:4000/">http://localhost:4000/</a> 可以看到部署的hexo博客</p><p><img src="https://cdn.jsdelivr.net/gh/C-Plusone/Pic@main/blog/01pic/blog03.jpg"></p><p>Ctrl+C停止程序</p><p>需要更换主题，自行更换并配置</p><blockquote><p>如过程中出现错误先点击此处<a href="http://www.baidu.com/">查找</a>解决访问，然后再行提问</p></blockquote><h3 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h3><ul><li><p>打开桌面blog文件夹</p></li><li><p>打开_config.yml文件，配置deploy:</p></li></ul><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">deploy:  type: <span class="token function">git</span>  repository: git@github.com:你的用户名/你的用户名.github.io.git  branch: main<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h3 id="创建workflows"><a href="#创建workflows" class="headerlink" title="创建workflows"></a>创建workflows</h3><ul><li>在blog下创建文件夹.github\workflows新建文件deploy.yml</li><li>workflows下新建文件deploy.yml文件名字可以自己改，但是文件一定要放在 .github/workflows 目录中</li><li>文件中内容如下<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># Actions workflows name</span>name: HEXO DEPLOY<span class="token comment"># 触发条件</span>on:  workflow_dispatch:<span class="token comment"># 环境变量</span>env:  GIT_USER: <span class="token variable">${{secrets.GIT_USER}</span><span class="token punctuation">}</span>  GIT_EMAIL: <span class="token variable">${{secrets.GIT_EMAIL}</span><span class="token punctuation">}</span>jobs:  build:     runs-on: ubuntu-latest             steps:    <span class="token comment"># check it to your workflow can access it</span>    <span class="token comment"># from: https://github.com/actions/checkout</span>    - name: Checkout      uses: actions/checkout@main          <span class="token comment"># from: https://github.com/actions/setup-node  </span>    - name: Setup Node.js      uses: actions/setup-node@main      with:        node-version: <span class="token string">"16.x"</span>        - name: Setup Hexo Dependencies      run: <span class="token operator">|</span>        <span class="token function">npm</span> <span class="token function">install</span> hexo-cli -g        <span class="token function">npm</span> <span class="token function">install</span>        - name: Setup Deploy Private Key      env:        HEXO_DEPLOY: <span class="token variable">${{secrets.HEXO_DEPLOY}</span><span class="token punctuation">}</span>      run: <span class="token operator">|</span>        <span class="token function">mkdir</span> -p ~/.ssh/        <span class="token builtin class-name">echo</span> <span class="token string">"<span class="token variable">$HEXO_DEPLOY</span>"</span> <span class="token operator">&gt;</span> ~/.ssh/id_rsa         <span class="token function">chmod</span> <span class="token number">600</span> ~/.ssh/id_rsa        ssh-keyscan github.com <span class="token operator">&gt;&gt;</span> ~/.ssh/known_hosts            - name: Setup Git Infomation      run: <span class="token operator">|</span>         <span class="token function">git</span> config --global user.name <span class="token variable">$GIT_USER</span>        <span class="token function">git</span> config --global user.email <span class="token variable">$GIT_EMAIL</span>    - name: Deploy Hexo       run: <span class="token operator">|</span>        hexo clean        hexo deploy<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li></ul><hr><h2 id="Github方面"><a href="#Github方面" class="headerlink" title="Github方面"></a>Github方面</h2><p>登录GitHub</p><h3 id="创建仓库"><a href="#创建仓库" class="headerlink" title="创建仓库"></a>创建仓库</h3><ul><li>一个私有仓库</li></ul><p>私有仓库名字可以随便起</p><p><img src="https://cdn.jsdelivr.net/gh/C-Plusone/Pic@main/blog/01pic/blog04.jpg"></p><ul><li>一个公共仓库</li></ul><p>公共仓库名必须为：你的用户名.github.io</p><p><img src="https://cdn.jsdelivr.net/gh/C-Plusone/Pic@main/blog/01pic/blog05.jpg"></p><h3 id="生成秘钥"><a href="#生成秘钥" class="headerlink" title="生成秘钥"></a>生成秘钥</h3><p>打开Git Bash Here输入:</p><pre class="line-numbers language-none"><code class="language-none">ssh-keygen -t rsa -C "email@example.com"<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>一直回车到结束<br>会生成两个文件，一个私钥一个公钥<br>默认生成到C:\Users\用户名.ssh里</p><p><img src="https://cdn.jsdelivr.net/gh/C-Plusone/Pic@main/blog/01pic/blog06.jpg"></p><h3 id="配置公钥"><a href="#配置公钥" class="headerlink" title="配置公钥"></a>配置公钥</h3><p>进入github设置</p><p><img src="https://cdn.jsdelivr.net/gh/C-Plusone/Pic@main/blog/01pic/blog07.jpg"></p><p>SSH and GPG key -&gt; 新建密钥New SSH key</p><p><img src="https://cdn.jsdelivr.net/gh/C-Plusone/Pic@main/blog/01pic/blog08.jpg"></p><p>打开id_rsa.pub<br>把里面内容复制粘贴到key里面，然后添加</p><p><img src="https://cdn.jsdelivr.net/gh/C-Plusone/Pic@main/blog/01pic/blog09.jpg"></p><p>添加完后测试一下<br>打开Git Bash Here输入:</p><pre class="line-numbers language-none"><code class="language-none">ssh -T git@github.com<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>首次需要同意<br>当出现下图表示成功</p><p><img src="https://cdn.jsdelivr.net/gh/C-Plusone/Pic@main/blog/01pic/blog10.jpg"></p><h3 id="配置私钥-机密"><a href="#配置私钥-机密" class="headerlink" title="配置私钥-机密"></a>配置私钥-机密</h3><p>进入私有仓库 -&gt; Settings -&gt; Secrets</p><p><img src="https://cdn.jsdelivr.net/gh/C-Plusone/Pic@main/blog/01pic/blog11.jpg"></p><p>创建三个secrets</p><ul><li>GIT_EMAIL：填入你的GitHubEmail，保存</li><li>GIT_USER： 填入你的GitHub用户名，保存</li><li>HEXO_DEPLOY：填入私钥即打开id_rsa里面的内容，保存</li></ul><hr><h2 id="把项目推送到私有仓库"><a href="#把项目推送到私有仓库" class="headerlink" title="把项目推送到私有仓库"></a>把项目推送到私有仓库</h2><p>打开桌面blog文件夹<br>输入命令：</p><pre class="line-numbers language-none"><code class="language-none">hexo cleangit initgit add .git commit -m "first commit"git branch -M maingit remote add origin git@github.com:你的用户名/你的私有仓库名.gitgit push -u origin main<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>至此项目就推送到你的私有仓库</p><h2 id="触发Workflow"><a href="#触发Workflow" class="headerlink" title="触发Workflow"></a>触发Workflow</h2><p>进入私有仓库 -&gt; Actions -&gt; HEXO DEPLOY -&gt; Run workflow</p><p><img src="https://cdn.jsdelivr.net/gh/C-Plusone/Pic@main/blog/01pic/blog12.jpg"></p><p>等待运行完成，就会生成推送到你的Github Pages上，即你的新建的共有仓库</p><p>打开网址，你的用户名.github.io，就会看到生成的博客了</p><blockquote><blockquote><blockquote><p>至此已全部部署完成</p></blockquote></blockquote></blockquote><hr><blockquote><p>后期添加文章只需要在/source/_posts/目录下添加编辑即可,编辑完成后触发一下这个Workflow就会自动更新到你的博客上</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> 教程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Github </tag>
            
            <tag> Github Actions </tag>
            
            <tag> 博客 </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
